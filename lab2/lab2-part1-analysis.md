### **Анализ защищённости разработанного приложения**

#### **1. Анализ с точки зрения политики безопасности операционной системы (ОС)**

Этот аспект рассматривает, как операционная система (в нашем случае Arch Linux) может быть настроена для защиты приложения и его данных от несанкционированного доступа со стороны других пользователей или процессов в той же системе.

*   **Права доступа к файлам (File Permissions):** Это фундаментальный механизм защиты в Linux.
    *   **Файл скрипта (`main.py`):** Для этого файла следует установить права `700` (`-rwx------`). Это означает, что только владелец файла (пользователь, от имени которого запускается скрипт) может его читать, изменять (write) и исполнять (execute). Это критически важно для предотвращения несанкционированных модификаций кода приложения другими пользователями системы.
    *   **Файлы данных (`users.json`, `confidential_data.enc`, `non_confidential_data.json`):** Для этих файлов должны быть установлены права `600` (`-rw-------`). Это даёт право на чтение и запись только владельцу. Никто другой в системе не сможет прочитать содержимое этих файлов, даже если получит доступ к системе под другой учётной записью. Это напрямую защищает зашифрованные данные и хеши паролей от прямого копирования.

*   **Принцип наименьших привилегий (Principle of Least Privilege):**
    *   Приложение должно запускаться от имени обычного, непривилегированного пользователя, **а не от root**. Если в приложении будет обнаружена уязвимость (например, позволяющая выполнить произвольный код), ущерб от её эксплуатации будет ограничен правами этого пользователя. Запуск от имени root предоставил бы злоумышленнику полный контроль над всей операционной системой.

---

#### **2. Анализ с точки зрения политики безопасности компонентов приложения и их взаимодействия**

Здесь мы анализируем внутреннюю логику самого кода: как разные его части работают вместе для обеспечения безопасности.

*   **Аутентификация и хранение учётных данных:**
    *   **Хеширование паролей:** Приложение **не хранит пароли в открытом виде**. Вместо этого используется функция формирования ключа на основе пароля `PBKDF2HMAC`. Это современный и надёжный стандарт. Он намеренно сделан медленным, что значительно усложняет атаки методом перебора (брутфорс).
    *   **Использование "соли" (Salting):** Для каждого пользователя генерируется уникальная криптографическая соль (`os.urandom(16)`). Соль добавляется к паролю перед хешированием. Это защищает от атак с использованием "радужных таблиц" (заранее вычисленных хешей) и гарантирует, что даже если два пользователя установят одинаковые пароли, их хеши в файле `users.json` будут абсолютно разными.

*   **Управление сессиями:**
    *   Сессия пользователя реализована с помощью глобальных переменных `current_user` и `encryption_key`. Они инициализируются при успешном входе и обнуляются (`None`) при выходе.
    *   **Безопасность:** Для простого консольного приложения такой подход является безопасным. Ключ шифрования и идентификатор пользователя существуют **только в оперативной памяти** и только во время работы программы. При завершении работы приложения эта информация бесследно исчезает. Функция `logout_user` корректно уничтожает сессию, немедленно лишая доступа к защищённым данным.

*   **Авторизация (проверка прав доступа):**
    *   В приложении реализовано чёткое разделение прав. Доступ к функции управления конфиденциальными данными `manage_data(is_confidential=True)` жёстко контролируется проверкой `if not current_user:`. Это гарантирует, что ни один неавторизованный пользователь не сможет даже попытаться выполнить операции с зашифрованными данными.

---

#### **3. Анализ с точки зрения сетевой политики безопасности**

Этот пункт оценивает уязвимость приложения к атакам из сети.

*   **Сетевое взаимодействие:** Приложение является **полностью локальным**. Оно не открывает сетевые порты, не принимает входящие соединения и не отправляет данные по сети.
*   **Векторы атак:** Вследствие отсутствия сетевой активности, приложение неуязвимо для целого класса атак, таких как:
    *   **Атака "человек посередине" (Man-in-the-Middle):** Перехватывать нечего.
    *   **Анализ трафика (Sniffing):** Трафика нет.
    *   **DoS/DDoS-атаки:** Атаковать нечего.
    *   **Межсайтовый скриптинг (XSS), SQL-инъекции и другие веб-уязвимости:** Неприменимо, так как это не веб-приложение.

---

#### **4. Анализ с точки зрения безопасности конфиденциальности данных**

Этот пункт фокусируется на том, как защищены сами секретные данные, которые хранит пользователь.

*   **Шифрование при хранении (Encryption at Rest):**
    *   Все конфиденциальные данные, прежде чем быть записанными в файл `confidential_data.enc`, шифруются с помощью надёжного симметричного алгоритма (`Fernet` из библиотеки `cryptography`, который под капотом использует AES).
    *   Это означает, что даже если злоумышленник обойдёт защиту на уровне ОС и получит копию файла `confidential_data.enc`, он получит лишь бессмысленный набор байтов, который невозможно прочитать без ключа.

*   **Управление ключами шифрования (Key Management):** Это самый сильный аспект защиты в данном приложении.
    *   **Ключ не хранится на диске:** Ключ шифрования `encryption_key` **никогда не сохраняется в файл**.
    *   **Динамическая генерация:** Ключ генерируется в момент входа пользователя в систему. Он создаётся из комбинации пароля пользователя и его персональной соли с помощью `PBKDF2HMAC`. Это гарантирует, что у каждого пользователя свой уникальный ключ.
    *   **Хранение в оперативной памяти:** Ключ существует только в RAM и только на время активной сессии пользователя.
    *   **Уничтожение ключа:** При выходе из системы или закрытии программы ключ немедленно уничтожается.
